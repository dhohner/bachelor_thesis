/**
 cm-frontend 2.0.0 
 Branch: master 
 Created:  19.12.2018 13:58 
**/

function commonAjaxify(){window.HCF&&HCF.ajaxify(),"object"==typeof App&&"object"==typeof App.ajaxify&&"function"==typeof App.ajaxify.init&&App.ajaxify.init()}function abOpenerelement(){if(context.client.isHandelsblatt&&!abOpenerActive){var e=document.querySelectorAll(".vhb-mega-type3 img")[0];if(e){document.body.className+=" ab-openerelement",document.getElementsByClassName("vhb-mega-type3")[0].style.opacity="0";var t=e.getAttribute("data-src").replace("format2101","format2003");e.setAttribute("src",t),e.setAttribute("data-src",t);var n=document.querySelectorAll(".vhb-mega-type3 .vhb-teaser-2--content .vhb-teaser-content")[0];document.querySelectorAll(".vhb-mega-type3 .vhb-teaser-2--content")[0].removeChild(n);var o=n.cloneNode(!0);document.querySelectorAll(".vhb-mega-type3 .vhb-teaser--background .vhb-teaser-headposition .vhb-teaser-head")[0].appendChild(o);var i=document.querySelectorAll(".vhb-mega-type3 .vhb-teaser--wrapper .vhb-teaser-service")[0];document.querySelectorAll(".vhb-mega-type3 .vhb-teaser--wrapper")[0].removeChild(i);var r=i.cloneNode(!0);document.querySelectorAll(".vhb-mega-type3 .vhb-teaser--background .vhb-teaser-headposition .vhb-teaser-head")[0].appendChild(r),document.getElementsByClassName("vhb-mega-type3")[0].style.opacity="1"}context.tech.hasLocalStorage&&localStorage.setItem("abaufmacher","true")}}if(window.iHelp={},iHelp.domainFromUrl=function(e){var t,n="";return(t=e.match(/^(?:.*:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n\?\=]+)/im))&&(t=(n=t[1]).match(/^[^\.]+\.(.+\..+)$/))&&(n=t[1]),n},iHelp.newDiv=function(e,t){var n=document.createElement("div");n.setAttribute("id",e),document.body.appendChild(n),document.getElementById(e).innerHTML=t},iHelp.getCookie=function(e){return 0<document.cookie.length&&(c_start=document.cookie.indexOf(e+"="),-1!=c_start)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),decodeURIComponent(document.cookie.substring(c_start,c_end))):""},iHelp.getHTML=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status&&t(this.responseText)},n.open("GET",e),n.send()},iHelp.addClass=function(e,t){e.className+=" "+t},iHelp.removeClass=function(e,t){e.className=e.className.replace(new RegExp(" "+t,"g"),"")},iHelp.configError=function(e){return console.error("Configuration Error> "+e),-1},iHelp.windowScrollTop=function(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)},window._commonAjaxify={},function(){var e=!1,t="modernizr";try{localStorage.setItem(t,t),localStorage.removeItem(t),e=!0}catch(e){}"undefined"==typeof JSON&&(e=!1);var n="unknown",o=document.querySelector('meta[http-equiv="Config"]');if(o)try{n=JSON.parse(o.getAttribute("content").replace(/&quote;/g,'"')).webtrekk.customParameter[1]}catch(e){}var i=!0,r=!1,a=!1,c=!1,s=!1;window.hcf_userconfig&&(i=!1,r=hcf_userconfig.logged,a=hcf_userconfig.cgi_adb_granting_product&&-1<hcf_userconfig.cgi_adb_granting_product.indexOf("HB-"),c="ALLOWED"!==hcf_userconfig.cgi_contentaccess,s=!0===hcf_userconfig.isStudioPreview);var d="";if(!r&&!a){var l=window.location.href,u=window.location.origin,m="";~location.host.split(".").shift().indexOf("-")&&(m="e2e-");d="https://"+m+"id.handelsblatt.com/login?service="+u+"/ajaxentry/nocache/ssohandshake?redirecturl=https://"+m+"finanzen.handelsblatt.com/redirect.htn?e=1%26url="+l}window.context={website:{isAdvertorial:!!~window.location.href.indexOf("/adv/"),isArticle:"Article"===n,isHomepage:"Homepage"===n,isIndex:"Rubrikenseite"===n,isUnknown:"unknown"===n,isProd:!~location.host.split(".").shift().indexOf("-"),hasPaywall:c,isStudioPreview:s,isShadowLayerActive:!1,loginUrl:d,isPrint:!!document.querySelector(".vhb-article-print")},client:{isHandelsblatt:-1<document.body.className.indexOf("is-hbo"),isMEW:-1<document.body.className.indexOf("is-mew"),isEdison:-1<document.body.className.indexOf("edison"),isKarriere:-1<document.body.className.indexOf("karriere"),lang:document.documentElement.lang||"de"},user:{isUnknown:i,isGuest:!r,isFree:r&&!a,isPremium:a,referredBy:e?void 0===document.referrer||~document.referrer.indexOf(window.location.host)||sessionStorage.getItem("referrer")===document.referrer?sessionStorage.getItem("referrer"):(sessionStorage.setItem("referrer",document.referrer),document.referrer):void 0===document.referrer||~document.referrer.indexOf(window.location.host&&null!==document.referrer)?"":document.referrer,wantsNoCommercial:!1},tech:{isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,isAndroid:-1<navigator.userAgent.toLowerCase().indexOf("android"),isPrivateMode:"tbd",hasLocalStorage:e},teststate:{}};var f=0,h=document.querySelector("footer,#hb-content-footer");h.addEventListener("click",function(){20<++f&&(h.innerHTML='<pre style="font-size: 15px;">'+JSON.stringify(window.context,null,1)+"<br />document.referrer: "+document.referrer+" <br /> NoAd: "+noAd+" </pre>")})}(),function(){var t="***MISSING TRANSLATION***",n={helloWorld:{en:"Hello world",de:"Hallo Welt"}};window.i18n={get:function(e){return n[e]?n[e][context.client.lang]||t:(console.warn("i18n missing translation for key "+e),t)}}}(),-1<location.href.indexOf("test=automation")&&(console.log("Test Automation Enabled"),document.body.classList.add("js-test-automation"),isTestAutomation=!0),function(){if(-1===location.href.indexOf("state="))return;var e=window.location.href.match("[?&]state=([^&#]+)"),t=e?e[1].split(","):[],n={hello:{desc:"Hello World",func:function(){console.log("Hello World!")}},scrolled:{desc:"Scroll 100% down",func:function(){window.addEventListener("load",function(e){window.scroll(0,window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight)})}},andup:{desc:"Scroll 50% up after 10ms",func:function(){window.addEventListener("load",function(e){setTimeout(function(){window.scroll(0,.2*(window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight))},100)})}},menu:{desc:"Open menu",func:function(){window.addEventListener("load",function(e){document.querySelector('[title="MenÃ¼"],#hb-app-btn-appmenu').click()})}},noheadfoot:{desc:"Hide header and footer",func:function(){document.querySelector("header,#hb-app-header").style.display="none",document.querySelector("footer,#hb-content-footer").style.display="none"}},adblocker:{desc:"Show AdBlocker Blocker",func:function(){document.getElementById("js-sorensen").style.display="none",context.website.hasPaywall=!1,context.user.isPremium=!1}},pagestrategy:{desc:"Highlight Ads and Artikelanker in article",func:function(){document.body.classList.add("u-show-ads"),window.IQD={}}},referrer:{desc:'Set referrer to PARAM, e.g. "referrer:xing.com"',func:function(e){context.user.referredBy=e,sessionStorage.setItem("referrerMetering","2")}},setios:{desc:"Set context tech to iOS",func:function(){context.tech.isIOS=!0}},setpremium:{desc:"Set context user to premium",func:function(){context.user.isPremium=!0,context.user.isUnknown=!1}},setadvertorial:{desc:"Set context website to advertorial",func:function(){context.website.isAdvertorial=!0}},showInactivityLayer:{desc:"Show Inactivity Layer. Overwrite delay with :n parameter, e.g. showInactivityLayer:5 ",func:function(e){e=e||-1,context.teststate.inactivitylayerDelay=parseInt(e,10)}},serverstats:{desc:"Show server statistics comment in website",func:function(){window.addEventListener("DOMContentLoaded",function(e){var t=document.createElement("pre");t.innerHTML=(new XMLSerializer).serializeToString(document).split("powered by").pop().split("] --\x3e").shift(),t.style.padding="10px",t.style.fontSize="30px",t.style.whiteSpace="normal",document.body.insertBefore(t,document.body.firstChild)})}}};if(0===(t=t.filter(function(e){return e})).length){var o="Available states: \n";for(var i in n)o+=i+" = "+n[i].desc+"\n";var r=document.createElement("pre");return r.innerHTML=o,r.style.padding="10px",document.body.insertBefore(r,document.body.firstChild)}for(var a=0,c=t.length;a<c;a+=1){var s,d=t[a],l=d.split(":");2===l.length&&(d=l[0],s=l[1]),n[d]?n[d].func(s):console.log("StateFunction "+t[a]+" not available!")}}(),window._commonAjaxify.HenrikAastedSorensen=function(a){a.length&&1===a.length&&(a=a[0]),window.addEventListener("load",function(){var e=document.getElementById("js-sorensen");if(!!e&&0===e.offsetWidth&&0===e.offsetHeight&&(context.user.wantsNoCommercial=!0),context.website.hasPaywall||context.user.isPremium)return!1;var t=a.getAttribute("data-exclude"),n=window.location.pathname,o=document.querySelector(".vhb-article-area--read"),r=a.getAttribute("data-url");context.user.wantsNoCommercial&&(void 0!==t&&""!==r&&-1===t.indexOf(n)||"/"===n)&&(r=r.replace(/[^\d]/g,""),iHelp.getHTML("/ajaxentry/nocache/renderTemplate?tId="+r+"&esi=true&view=layer",function(e){iHelp.newDiv("shadowlayer--wrapper",e),window.commonAjaxify(),wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"HenrikAastedSorensen aktiv"}});var t=document.querySelector(".c-sorensen__login");if(t&&t.setAttribute("href",window.context.website.loginUrl),o){document.body.classList.add("is-sorensen-active");var n=o.innerText,a="ABCDEFGHIJKLMNOPQRSTUVWXYZ";o.innerText=function(e){var t,n=e,o=function(){for(var e="",t=0;t<=26;t++)e+=a.charAt(Math.floor(Math.random()*a.length));return e}(),r="";for(n=n.toUpperCase(),i=0;i<n.length;i++)-1<(t=a.indexOf(n.charAt(i)))&&(r+=o.charAt(t));return r}(n)}}))})},function(){if(!window.context.client.isHandelsblatt)return;var e=document.querySelector("[name=vhb-reload-popup]");if(e&&"false"===e.content)return;if(context.website.isStudioPreview)return;var t={htmlbox:"/ajaxentry/cache/teasablecontent?esi=true&tgId=13935228",counter:0,interval:void 0,active:void 0!==context.teststate.inactivitylayerDelay,maxTicks:context.teststate.inactivitylayerDelay||120};function n(){t.counter=0}function o(){t.active=!0}function i(){n(),o()}document.addEventListener("keypress",n),document.addEventListener("click",i),document.addEventListener("touchmove",i),document.addEventListener("mousemove",i),document.addEventListener("touchend",i),window.addEventListener("scroll",function(e){!t.active&&0<iHelp.windowScrollTop&&o(),n()}),window.addEventListener("focus",o),window.addEventListener("blur",o),t.interval=window.setInterval(function(){return void 0!==context.teststate.inactivitylayerDelay&&console.log("inactivitylayer> "+t.counter,t.active),!!t.active&&(!document.querySelectorAll(".vjs-playing").length&&(!(-1<document.body.className.indexOf("vhb-modal-active"))&&void(++t.counter>t.maxTicks&&(clearInterval(t.interval),window.context.website.isShadowLayerActive||iHelp.getHTML(t.htmlbox,function(e){iHelp.newDiv("shadowlayer--wrapper",e),window.commonAjaxify(),"undefined"!=typeof wt&&wt.sendinfo({linkId:"Layer",customClickParameter:{6:"Reload-Layer"}})})))))},1e3)}(),context.client.isHandelsblatt){var datasrc=$(".vhb-c-nav-logos").find("img.lazy"),image=datasrc.data("src");datasrc.attr("src",image)}window._commonAjaxify.listingtool=function(t){if(t.length&&1===t.length&&(t=t[0]),!GLOBAL.LISTING_TOOL_API)return iHelp.configError("Ajaxify listingtool requires GLOBAL.LISTING_TOOL_API");var n="js-loading",o=t.querySelector(".js-listingtool-select"),i=t.querySelector(".js-listingtool-target"),r={category:""};function a(){iHelp.addClass(t,n);var e="https://"+GLOBAL.LISTING_TOOL_API+"/companies";r.category&&(e+="/"+r.category),-1<location.host.indexOf("preview-")&&(e+="?preview=true"),iHelp.getHTML(e,function(e){i.innerHTML=e,iHelp.removeClass(t,n),window.commonAjaxify()})}o&&o.addEventListener("change",function(){var e=o.options[o.selectedIndex];r.category=e.dataset.category?e.dataset.category:"",a()}),a(),iHelp.removeClass(t,"js-init")},window._commonAjaxify.protectedFrame=function(e){e.length&&1===e.length&&(e=e[0]);var t=location.href.match(/\/\d*.html.*$/),n=null===t?encodeURI(location.href):encodeURI(location.protocol+"//"+location.host+t[0]);(-1===n.indexOf("handelsblatt.com")||-1<n.indexOf("test-")||location.port)&&(n="https://www.handelsblatt.com/");var o="https://"+(-1===location.host.indexOf("e2e")?"":"e2e-")+"id.handelsblatt.com/login?iframe=true&service="+n;e.src=o},window._commonAjaxify.pushmodal=function(t){t.length&&1===t.length&&(t=t[0]);var n="pushModal",e=!0,o="question";function i(e){"ever"===e?document.cookie=n+"=close; expires=Fri, 31 Dec 9999 23:59:59 GMT":(date=new Date,date.setTime(date.getTime()+24*e*60*60*1e3),document.cookie=n+"=close; expires="+date.toGMTString())}function r(e){t.classList.remove("c-pushlayer--show"),i(e)}function a(){OneSignal.push(function(){OneSignal.on("notificationPermissionChange",function(e){"granted"===e.to?(OneSignal.sendTag("generalUpdatePushesEnabled","true"),OneSignal.sendTag("breakingNewsPushesEnabled","true"),OneSignal.sendTag("ePaperPushesEnabled","true"),OneSignal.sendTag("Desktop","true"),t.classList.remove("c-pushlayer--complete-activation"),t.classList.add("c-pushlayer--enabled"),o="successfeedback",wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"PushNotification-granted"}}),i()):(r("ever"),wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"PushNotification-denied"}}))}),OneSignal.isPushNotificationsEnabled(function(e){e?r("ever"):(t.classList.add("c-pushlayer--show"),wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"PushNotification-ModalShow"}}))})}),document.querySelector(".js--pn-close-x").addEventListener("click",function(){wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"PushNotification-close-"+o}}),r("30")}),document.querySelector(".js--pn-close-button").addEventListener("click",function(){wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"PushNotification-NeinDanke"}}),r("ever")}),document.querySelector(".js--pn-activate").addEventListener("click",function(){t.classList.remove("c-pushlayer--not-yet-activated"),t.classList.add("c-pushlayer--complete-activation"),o="explanation",wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"PushNotification-aktivieren"}}),OneSignal.registerForPushNotifications({})})}function c(){return"close"===iHelp.getCookie(n)}function s(){if(context.tech.hasLocalStorage)"NaN"===(e=localStorage.getItem("pageimpression"))?e=1:(e=parseInt(e),e+=1),localStorage.setItem("pageimpression",e);else var e=3;return e}if(document.onreadystatechange=function(){if("complete"===document.readyState){if(!1===e)return!1;var t=s();c()||OneSignal.push(function(){var e=OneSignal.isPushNotificationsSupported();console.log("isPushSupported: "+e),e?(localStorage.setItem("PushNotificationsSupported","true"),1<t&&a()):(r("ever"),localStorage.setItem("PushNotificationsSupported","false"))})}},context.tech.hasLocalStorage){console.log("pushmodal: localstorage");var d=s();"true"==localStorage.getItem("PushNotificationsSupported")&&(e=!1,c()||(1<d?(t.classList.add("c-pushlayer--show"),document.onreadystatechange=function(){"complete"===document.readyState&&a()}):OneSignal.isPushNotificationsEnabled(function(e){e&&r("ever")})))}},window._commonAjaxify.referrerAd=function(e){e.length&&1===e.length&&(e=e[0]);var t=e.dataset.referrer;if(!t)return!1;if(null===context.user.referredBy)return!1;if(context.website.hasPaywall)return!1;if(context.user.isPremium)return!1;if("false"===e.dataset.advertorials&&context.website.isAdvertorial)return!1;var n=context.user.referredBy?iHelp.domainFromUrl(context.user.referredBy):"",o=!!~document.location.search.toLowerCase().indexOf("share=whatsapp"),i=""===n&&context.tech.isIOS&&!o,r=!!~context.user.referredBy.indexOf(".yana");function a(t,n){iHelp.getHTML("/ajaxentry/nocache/renderTemplate?tId="+n.htmlBoxID+"&esi=true&view=layer",function(e){t.innerHTML=e,t.addEventListener("click",function(){window.wt.sendinfo({linkId:"Aktionstracking",customClickParameter:{12:"ReferrerAd-"+n.referrerName}})})})}if(context.tech.hasLocalStorage){if("0"===sessionStorage.getItem("referrerMetering"))return!1;if(sessionStorage.getItem("referrer"))if(sessionStorage.getItem("referrerMetering")){var c=sessionStorage.getItem("referrerMetering")-1;sessionStorage.setItem("referrerMetering",c)}else sessionStorage.setItem("referrerMetering","2")}var s={};for(var d in t.split(",").forEach(function(e){var t=e.split(":");t[1]&&(s[t[0]]=t[1])}),s)(r||"AppleNews"===d&&i||n===d)&&a(e,{htmlBoxID:s[d],referrerName:d})},window._commonAjaxify.shadowLayer=function(e){e.length&&1===e.length&&(e=e[0]),window.context.website.isShadowLayerActive=!0;var n=e.getAttribute("data-shadowLayer");document.querySelector(".c-shadowlayer").addEventListener("click",function(e){var t;e.target.hasAttribute("closeLayer")&&((t=document.getElementsByClassName("c-shadowlayer")[0]).parentNode.removeChild(t),wt.sendinfo({linkId:"Schliessen_Button",customClickParameter:{12:n+"-nicht-mehr-anzeigen"}}),window.context.website.isShadowLayerActive=!1)})},window._commonAjaxify.toggleClass=function(t){t.length&&1===t.length&&(t=t[0]),t.addEventListener("click",function(){var e=t.getAttribute("data-param");document.getElementById(e).classList.toggle("js-active")})},window._commonAjaxify.yougov=function(e){e.length&&1===e.length&&(e=e[0]),e.src=e.dataset.src+"&partner_logged_in="+!context.user.isGuest};